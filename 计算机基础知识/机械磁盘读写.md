面试问Kafka，引申到了机械磁盘读写的问题，没答上来，这里弥补下大学的知识吧~

先看下机械盘的内部构造：

![image](https://github.com/liuerge/Big-data-groping/blob/master/images_all_in_here/TTUP_images/s3lenegbuv%5B1%5D.jpg)

从这个俯视图可以看到内部的设计，下面看些横向的视图。

![image](https://github.com/liuerge/Big-data-groping/blob/master/images_all_in_here/TTUP_images/9f6k1y22hf%5B1%5D.jpg)

硬盘主要由盘体、控制电路和接口部件组成。

知识：

1，盘面

2，磁道

3，柱面

4，扇区



二、读写原理

1，写

写磁盘时，按照柱面、磁头、扇区的方式进行，即最先是第1磁道的第一磁头下（也就是第1盘面的第一磁道）的所有分区，然后是统一柱面的下一个磁头，一个柱面存储满后就会推进到下一个柱面，知道把文件内容全部写入磁盘。

​	

2，读

读取数据时，通过告诉磁盘控制器要读出上去所在的柱面号、磁头号和扇区号（物理地址的三个组成部分）。磁臂径向移动，磁头移动到对应的柱面，等待要求的扇区移动到磁头下。

扇区到来时，磁盘控制器读取出每个扇区的头标，把这些头标中的地址信息与检测处的磁头和柱面作比较，即寻道。然后，寻找要找的扇区号，找到后，按照读/写的任务 来决定是读出数据和尾部记录，还是转换写电路。

找到数据后，此磁盘控制器必须在继续寻找下一个分区之前对该扇区的信息进行处理。如果是读数据，控制器计算此数据的ECC码与已经记录的做对比。如果是写数据，则会把数据和ECC码一起存储。





三 顺序读写&随机读写

看来上面的应该会有一个认识了，随机读取，首先移动磁臂到对应的磁道，是寻道时间（机械盘一般是在7.5~14ms 每个磁盘出厂会有此项指标），然后盘片旋转寻找扇区（转速现在最低也是5400rpm，企业级的更高）。



Kafka的顺序读写!









































